{% extends 'base.html.twig' %}

{% block title %}Détail de {{ theme.name }}{% endblock %}

{% block body %}
    <div>

        <div>
            <h2>{{ theme.name }}</h2>
            <p>Créé le {{ theme.dateOfCreation|date('d/m/Y') }}</p>
        </div>

        <div>
            <h2>Informations</h2>
            ID : {{ theme.id }}
            {% if theme.createdBy %}
                Créé par : {{ theme.createdBy.username }}
            {% endif %}
        </div>

        {% if theme.cards|length > 0 %}
            <div>
                <h2>{{ theme.cards|length }} carte{{ theme.cards|length > 1 ? 's' }}</h2>
                {% for card in theme.cards %}
                    <div>
                        <h3>{{ card.title }}</h3>
                        <p>{{ card.detail|slice(0, 100) }}{% if card.detail|length > 100 %}...{% endif %}</p>
                        <a href="{{ path('cards_details', {'id': card.id}) }}">Voir</a>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        {% if theme.medias|length > 0 %}
            <div>
                <h2>{{ theme.medias|length }} média{{ theme.medias|length > 1 ? 's' }}</h2>
                {% for media in theme.medias %}
                    <div>
                        {% if media.type == 'image' %}
                            <img src="{{ asset('uploads/media/' ~ media.filePath) }}">
                        {% endif %}
                        <h3>{{ media.userGivenName }}</h3>
                        <a href="{{ path('media_detail', {'id': media.id}) }}">Détails</a>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        {% if theme.backgroundImage %}
            <div>
                <h2>Image de fond</h2>
                <img src="{{ asset('uploads/media/' ~ theme.backgroundImage.filePath) }}">
            </div>
        {% endif %}

        <div>
            <a href="{{ path('edit_theme', {'id': theme.id}) }}">Modifier</a>
            <a href="{{ path('home') }}">Retour</a>
            {% if is_granted('ROLE_ADMIN') %}
                {% if not theme.archived %}
                    <a href="{{ path('archive_theme', {'id': theme.id}) }}" onclick="return confirm('Archiver ?')">Archiver</a>
                {% else %}
                    <a href="{{ path('unarchive_theme', {'id': theme.id}) }}" onclick="return confirm('Désarchiver ?')">Désarchiver</a>
                {% endif %}
            {% endif %}
        </div>

    </div>
{% endblock %}
